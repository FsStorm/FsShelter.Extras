<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Bootstrapping the components
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Common component constructors for FsShelter"/>
    <meta name="author" content="Prolucid"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="https://prolucid.github.io/FsShelter.Extras/content/style.css" />
    <script type="text/javascript" src="https://prolucid.github.io/FsShelter.Extras/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="https://prolucid.github.io">prolucid</a></li>
          <li><a href="https://prolucid.github.io/FsShelter">FsShelter</a></li>
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="https://github.com/Prolucid/FsShelter.Extras">github page</a></li>
        </ul>
        <h3 class="muted"><a href="https://prolucid.github.io/FsShelter.Extras/index.html">FsShelter.Extras</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Bootstrapping-the-components" class="anchor" href="#Bootstrapping-the-components">Bootstrapping the components</a></h1>
<p>The component constructors are defined in a way that delays instantiation (and consequently environmental requirements) till the moment it's actually needed.
What it means is that when implemented correctly, configuration, runtime dependencies, database availability, etc are not demanded when we are just inspecting the topology. For example: to document the topology or submit it for execution.
Only when Storm brings it up for execution do we need to have everything in place and available, hence the bootstrap parametrization.</p>
<h1><a name="Exmaple" class="anchor" href="#Exmaple">Exmaple</a></h1>
<h3><a name="Messaging" class="anchor" href="#Messaging">Messaging</a></h3>
<p>Let's boostrap EventStreams consumers and publishers with Json assembly:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FsBunny</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">FsShelter</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Extras</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Assemblers</span>

<span class="c">/// DAL helpers</span>
<span class="k">module</span> <span class="t">RabbitMq</span> <span class="o">=</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">System</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">RabbitMQ</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">Client</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="f">mkEventStreams</span> (<span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="i">connectionString</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="t">string</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 11)" onmouseover="showTip(event, 'fs11', 11)" class="i">uri</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs12', 12)" onmouseover="showTip(event, 'fs12', 12)" class="t">Uri</span>(<span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="i">connectionString</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 14)" onmouseover="showTip(event, 'fs13', 14)" class="i">cf</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 15)" onmouseover="showTip(event, 'fs14', 15)" class="t">ConnectionFactory</span>(<span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="i">Uri</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs11', 17)" onmouseover="showTip(event, 'fs11', 17)" class="i">uri</span>)
        <span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="t">RabbitMqEventStreams</span>(<span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="i">cf</span>, <span class="s">&quot;amq.topic&quot;</span>, <span class="n">3us</span>, <span class="n">1000us</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="i">rabbit</span> <span class="o">=</span> <span class="s">&quot;amqp://localhost&quot;</span>

<span class="c">/// Create a consumer based on the arguments.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="f">withQueueConsumer</span> <span onmouseout="hideTip(event, 'fs18', 22)" onmouseover="showTip(event, 'fs18', 22)" class="i">topic</span> <span onmouseout="hideTip(event, 'fs19', 23)" onmouseover="showTip(event, 'fs19', 23)" class="i">queue</span> <span onmouseout="hideTip(event, 'fs20', 24)" onmouseover="showTip(event, 'fs20', 24)" class="i">log</span> <span onmouseout="hideTip(event, 'fs21', 25)" onmouseover="showTip(event, 'fs21', 25)" class="i">cfg</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 26)" onmouseover="showTip(event, 'fs22', 26)" class="i">eventStreams</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 27)" onmouseover="showTip(event, 'fs23', 27)" class="t">RabbitMq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 28)" onmouseover="showTip(event, 'fs8', 28)" class="f">mkEventStreams</span> <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="i">rabbit</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs24', 30)" onmouseover="showTip(event, 'fs24', 30)" class="t">EventStreams</span>
    <span onmouseout="hideTip(event, 'fs22', 31)" onmouseover="showTip(event, 'fs22', 31)" class="i">eventStreams</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 32)" onmouseover="showTip(event, 'fs25', 32)" class="f">GetJsonConsumer</span> (<span onmouseout="hideTip(event, 'fs26', 33)" onmouseover="showTip(event, 'fs26', 33)" class="p">Persistent</span> <span onmouseout="hideTip(event, 'fs19', 34)" onmouseover="showTip(event, 'fs19', 34)" class="i">queue</span>) (<span onmouseout="hideTip(event, 'fs22', 35)" onmouseover="showTip(event, 'fs22', 35)" class="i">eventStreams</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 36)" onmouseover="showTip(event, 'fs25', 36)" class="f">Routed</span> <span onmouseout="hideTip(event, 'fs18', 37)" onmouseover="showTip(event, 'fs18', 37)" class="i">topic</span>)

<span class="c">/// Create a routed publisher based on the arguments.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 38)" onmouseover="showTip(event, 'fs27', 38)" class="f">withPublisher</span> <span onmouseout="hideTip(event, 'fs28', 39)" onmouseover="showTip(event, 'fs28', 39)" class="f">publish</span> <span onmouseout="hideTip(event, 'fs29', 40)" onmouseover="showTip(event, 'fs29', 40)" class="i">log</span> <span onmouseout="hideTip(event, 'fs30', 41)" onmouseover="showTip(event, 'fs30', 41)" class="i">cfg</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 42)" onmouseover="showTip(event, 'fs22', 42)" class="i">eventStreams</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 43)" onmouseover="showTip(event, 'fs23', 43)" class="t">RabbitMq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 44)" onmouseover="showTip(event, 'fs8', 44)" class="f">mkEventStreams</span> <span onmouseout="hideTip(event, 'fs16', 45)" onmouseover="showTip(event, 'fs16', 45)" class="i">rabbit</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs24', 46)" onmouseover="showTip(event, 'fs24', 46)" class="t">EventStreams</span>
    <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs31', 47)" onmouseover="showTip(event, 'fs31', 47)" class="i">tuple</span> <span onmouseout="hideTip(event, 'fs32', 48)" onmouseover="showTip(event, 'fs32', 48)" class="i">emit</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs31', 49)" onmouseover="showTip(event, 'fs31', 49)" class="i">tuple</span>, <span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="f">publish</span> <span onmouseout="hideTip(event, 'fs22', 51)" onmouseover="showTip(event, 'fs22', 51)" class="i">eventStreams</span>

<span class="c">/// Publish Json</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 52)" onmouseover="showTip(event, 'fs33', 52)" class="f">publishJson</span> <span onmouseout="hideTip(event, 'fs34', 53)" onmouseover="showTip(event, 'fs34', 53)" class="i">exchange</span> (<span onmouseout="hideTip(event, 'fs22', 54)" onmouseover="showTip(event, 'fs22', 54)" class="i">eventStreams</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs24', 55)" onmouseover="showTip(event, 'fs24', 55)" class="t">EventStreams</span>) (<span onmouseout="hideTip(event, 'fs18', 56)" onmouseover="showTip(event, 'fs18', 56)" class="i">topic</span>,<span onmouseout="hideTip(event, 'fs35', 57)" onmouseover="showTip(event, 'fs35', 57)" class="i">msg</span>) <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs35', 58)" onmouseover="showTip(event, 'fs35', 58)" class="i">msg</span> <span class="o">|-&gt;</span> <span onmouseout="hideTip(event, 'fs22', 59)" onmouseover="showTip(event, 'fs22', 59)" class="i">eventStreams</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 60)" onmouseover="showTip(event, 'fs25', 60)" class="f">UsingJsonPublisher</span> (<span onmouseout="hideTip(event, 'fs36', 61)" onmouseover="showTip(event, 'fs36', 61)" class="p">Routed</span> (<span onmouseout="hideTip(event, 'fs34', 62)" onmouseover="showTip(event, 'fs34', 62)" class="i">exchange</span>,<span onmouseout="hideTip(event, 'fs18', 63)" onmouseover="showTip(event, 'fs18', 63)" class="i">topic</span>))
</code></pre></td>
</tr>
</table>
<h3><a name="Persistence" class="anchor" href="#Persistence">Persistence</a></h3>
<p>Now let's bootstrap some Cassandra reader and writer components:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// DAL helpers</span>
<span class="k">module</span> <span class="t">Cassandra</span> <span class="o">=</span>
  <span class="k">open</span> <span class="i">FsCassy</span>
  <span class="k">open</span> <span class="i">Cassandra</span><span class="o">.</span><span class="i">Mapping</span>

  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 64)" onmouseover="showTip(event, 'fs37', 64)" class="f">mkInterpreter</span> <span onmouseout="hideTip(event, 'fs38', 65)" onmouseover="showTip(event, 'fs38', 65)" class="f">mkSession</span> (<span onmouseout="hideTip(event, 'fs39', 66)" onmouseover="showTip(event, 'fs39', 66)" class="i">name</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs40', 67)" onmouseover="showTip(event, 'fs40', 67)" class="t">string</span>) <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 68)" onmouseover="showTip(event, 'fs41', 68)" class="i">session</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 69)" onmouseover="showTip(event, 'fs38', 69)" class="f">mkSession</span> <span onmouseout="hideTip(event, 'fs39', 70)" onmouseover="showTip(event, 'fs39', 70)" class="i">name</span>
    { <span class="k">new</span> <span class="i">Interpreter</span> <span class="k">with</span> 
        <span class="k">member</span> <span class="i">x</span><span class="o">.</span><span class="i">Interpret</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">t</span>,<span class="o">&#39;</span><span class="i">r</span><span class="o">&gt;</span> (<span class="i">statement</span><span class="o">:</span><span class="i">Statement</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">t</span>,<span class="o">&#39;</span><span class="i">r</span><span class="o">&gt;</span>) <span class="o">:</span> <span class="o">&#39;</span><span class="i">r</span><span class="o">=</span> 
          <span class="i">Cassandra</span><span class="o">.</span><span class="i">Interpreter</span><span class="o">.</span><span class="i">execute</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span class="i">Cassandra</span><span class="o">.</span><span class="i">Api</span><span class="o">.</span><span class="i">mkTable</span> (<span class="i">MappingConfiguration</span>()) <span onmouseout="hideTip(event, 'fs41', 71)" onmouseover="showTip(event, 'fs41', 71)" class="i">session</span>) <span class="i">statement</span> }

  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs42', 72)" onmouseover="showTip(event, 'fs42', 72)" class="f">mkSession</span> (<span onmouseout="hideTip(event, 'fs9', 73)" onmouseover="showTip(event, 'fs9', 73)" class="i">connectionString</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs40', 74)" onmouseover="showTip(event, 'fs40', 74)" class="t">string</span>) <span class="o">=</span>
    <span class="i">Cassandra</span><span class="o">.</span><span class="i">Api</span><span class="o">.</span><span class="i">mkCluster</span> <span onmouseout="hideTip(event, 'fs9', 75)" onmouseover="showTip(event, 'fs9', 75)" class="i">connectionString</span>
    <span class="o">|&gt;</span> <span class="i">Cassandra</span><span class="o">.</span><span class="i">Api</span><span class="o">.</span><span class="i">mkSession</span> <span onmouseout="hideTip(event, 'fs43', 76)" onmouseover="showTip(event, 'fs43', 76)" class="i">id</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 77)" onmouseover="showTip(event, 'fs44', 77)" class="i">cassandra</span> <span class="o">=</span> <span class="s">&quot;contact points=localhost;default keyspace=sample&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs45', 78)" onmouseover="showTip(event, 'fs45', 78)" class="f">withPersisterArgs</span> <span onmouseout="hideTip(event, 'fs20', 79)" onmouseover="showTip(event, 'fs20', 79)" class="i">log</span> <span onmouseout="hideTip(event, 'fs21', 80)" onmouseover="showTip(event, 'fs21', 80)" class="i">cfg</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 81)" onmouseover="showTip(event, 'fs46', 81)" class="i">persister</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 82)" onmouseover="showTip(event, 'fs47', 82)" class="t">Cassandra</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 83)" onmouseover="showTip(event, 'fs37', 83)" class="f">mkInterpreter</span> <span onmouseout="hideTip(event, 'fs47', 84)" onmouseover="showTip(event, 'fs47', 84)" class="t">Cassandra</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 85)" onmouseover="showTip(event, 'fs42', 85)" class="f">mkSession</span> <span onmouseout="hideTip(event, 'fs44', 86)" onmouseover="showTip(event, 'fs44', 86)" class="i">cassandra</span>
    <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs48', 87)" onmouseover="showTip(event, 'fs48', 87)" class="i">input</span> <span onmouseout="hideTip(event, 'fs49', 88)" onmouseover="showTip(event, 'fs49', 88)" class="i">emit</span> <span class="k">-&gt;</span>
        (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs50', 89)" onmouseover="showTip(event, 'fs50', 89)" class="f">f</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs50', 90)" onmouseover="showTip(event, 'fs50', 90)" class="f">f</span> <span onmouseout="hideTip(event, 'fs46', 91)" onmouseover="showTip(event, 'fs46', 91)" class="i">persister</span>), <span onmouseout="hideTip(event, 'fs48', 92)" onmouseover="showTip(event, 'fs48', 92)" class="i">input</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 93)" onmouseover="showTip(event, 'fs51', 93)" class="f">withReaderArgs</span> <span onmouseout="hideTip(event, 'fs20', 94)" onmouseover="showTip(event, 'fs20', 94)" class="i">log</span> <span onmouseout="hideTip(event, 'fs21', 95)" onmouseover="showTip(event, 'fs21', 95)" class="i">cfg</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 96)" onmouseover="showTip(event, 'fs46', 96)" class="i">persister</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 97)" onmouseover="showTip(event, 'fs47', 97)" class="t">Cassandra</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 98)" onmouseover="showTip(event, 'fs37', 98)" class="f">mkInterpreter</span> <span onmouseout="hideTip(event, 'fs47', 99)" onmouseover="showTip(event, 'fs47', 99)" class="t">Cassandra</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 100)" onmouseover="showTip(event, 'fs42', 100)" class="f">mkSession</span> <span onmouseout="hideTip(event, 'fs44', 101)" onmouseover="showTip(event, 'fs44', 101)" class="i">cassandra</span>
    <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs48', 102)" onmouseover="showTip(event, 'fs48', 102)" class="i">input</span> <span onmouseout="hideTip(event, 'fs49', 103)" onmouseover="showTip(event, 'fs49', 103)" class="i">emit</span> <span class="k">-&gt;</span>
        (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs50', 104)" onmouseover="showTip(event, 'fs50', 104)" class="f">f</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs50', 105)" onmouseover="showTip(event, 'fs50', 105)" class="f">f</span> <span onmouseout="hideTip(event, 'fs46', 106)" onmouseover="showTip(event, 'fs46', 106)" class="i">persister</span>), <span onmouseout="hideTip(event, 'fs48', 107)" onmouseover="showTip(event, 'fs48', 107)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs49', 108)" onmouseover="showTip(event, 'fs49', 108)" class="i">emit</span>
</code></pre></td>
</tr>
</table>
<h3><a name="Implementing-component-logic" class="anchor" href="#Implementing-component-logic">Implementing component logic</a></h3>
<p>FsShelter provides the runtime, the Extras components outline the role of the component, and the bootstrap parameters wire the configured providers, but the user provides the logic.
Let's implement some of the components. We'll model some sensors, take the readings as messages coming in and raise an alarm by sending a message if the temperature readings exceed a threshold.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs5', 109)" onmouseover="showTip(event, 'fs5', 109)" class="i">System</span>
<span class="k">open</span> <span class="i">FsCassy</span>

<span class="c">/// Events and Notifications</span>
[&lt;<span onmouseout="hideTip(event, 'fs52', 110)" onmouseover="showTip(event, 'fs52', 110)" class="t">AutoOpen</span>&gt;]
<span class="k">module</span> <span class="t">Messaging</span> <span class="o">=</span>
  <span class="k">type</span> <span onmouseout="hideTip(event, 'fs53', 111)" onmouseover="showTip(event, 'fs53', 111)" class="t">SensorReading</span> <span class="o">=</span> 
    { <span onmouseout="hideTip(event, 'fs54', 112)" onmouseover="showTip(event, 'fs54', 112)" class="i">Id</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs55', 113)" onmouseover="showTip(event, 'fs55', 113)" class="t">Guid</span>; <span onmouseout="hideTip(event, 'fs56', 114)" onmouseover="showTip(event, 'fs56', 114)" class="i">Temp</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs57', 115)" onmouseover="showTip(event, 'fs57', 115)" class="t">int</span>}

  <span class="k">type</span> <span onmouseout="hideTip(event, 'fs58', 116)" onmouseover="showTip(event, 'fs58', 116)" class="t">SensorAlert</span> <span class="o">=</span> 
    { <span onmouseout="hideTip(event, 'fs59', 117)" onmouseover="showTip(event, 'fs59', 117)" class="i">Id</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs55', 118)" onmouseover="showTip(event, 'fs55', 118)" class="t">Guid</span>; <span onmouseout="hideTip(event, 'fs60', 119)" onmouseover="showTip(event, 'fs60', 119)" class="i">Text</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 120)" onmouseover="showTip(event, 'fs10', 120)" class="t">string</span> }

<span class="c">/// Cassandra-mapped types</span>
[&lt;<span onmouseout="hideTip(event, 'fs52', 121)" onmouseover="showTip(event, 'fs52', 121)" class="t">AutoOpen</span>&gt;]
<span class="k">module</span> <span class="t">Persistence</span> <span class="o">=</span>
  <span class="k">type</span> <span onmouseout="hideTip(event, 'fs61', 122)" onmouseover="showTip(event, 'fs61', 122)" class="t">Sensor</span> <span class="o">=</span> 
    { <span onmouseout="hideTip(event, 'fs62', 123)" onmouseover="showTip(event, 'fs62', 123)" class="i">Id</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs55', 124)" onmouseover="showTip(event, 'fs55', 124)" class="t">Guid</span>; <span onmouseout="hideTip(event, 'fs63', 125)" onmouseover="showTip(event, 'fs63', 125)" class="i">Value</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs57', 126)" onmouseover="showTip(event, 'fs57', 126)" class="t">int</span>}

<span class="c">/// Topology streams</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs64', 127)" onmouseover="showTip(event, 'fs64', 127)" class="t">Stream</span> <span class="o">=</span>
    | <span onmouseout="hideTip(event, 'fs65', 128)" onmouseover="showTip(event, 'fs65', 128)" class="p">Update</span> <span class="k">of</span> <span class="i">sensorId</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs55', 129)" onmouseover="showTip(event, 'fs55', 129)" class="t">Guid</span> <span class="o">*</span> <span class="i">temp</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs57', 130)" onmouseover="showTip(event, 'fs57', 130)" class="t">int</span>
    | <span onmouseout="hideTip(event, 'fs66', 131)" onmouseover="showTip(event, 'fs66', 131)" class="p">Alarm</span> <span class="k">of</span> <span class="i">sensorId</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs55', 132)" onmouseover="showTip(event, 'fs55', 132)" class="t">Guid</span> <span class="o">*</span> <span class="i">temp</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs57', 133)" onmouseover="showTip(event, 'fs57', 133)" class="t">int</span>
    | <span onmouseout="hideTip(event, 'fs67', 134)" onmouseover="showTip(event, 'fs67', 134)" class="p">NotFound</span> <span class="k">of</span> <span class="i">sensorId</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs55', 135)" onmouseover="showTip(event, 'fs55', 135)" class="t">Guid</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 136)" onmouseover="showTip(event, 'fs68', 136)" class="f">sensorWriter</span> (<span onmouseout="hideTip(event, 'fs69', 137)" onmouseover="showTip(event, 'fs69', 137)" class="i">persister</span><span class="o">:</span><span class="i">Interpreter</span>) <span class="o">=</span> 
    <span class="k">function</span> 
    | <span onmouseout="hideTip(event, 'fs65', 138)" onmouseover="showTip(event, 'fs65', 138)" class="p">Update</span>(<span onmouseout="hideTip(event, 'fs70', 139)" onmouseover="showTip(event, 'fs70', 139)" class="i">id</span>, <span onmouseout="hideTip(event, 'fs71', 140)" onmouseover="showTip(event, 'fs71', 140)" class="i">temp</span>) <span class="k">-&gt;</span> 
            <span class="i">table</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs61', 141)" onmouseover="showTip(event, 'fs61', 141)" class="i">Sensor</span><span class="o">&gt;</span> 
        <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">where</span> (<span class="i">Quote</span><span class="o">.</span><span class="i">X</span>(<span class="k">fun</span> <span class="i">s</span> <span class="k">-&gt;</span> <span class="i">s</span><span class="o">.</span><span class="i">Id</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs70', 142)" onmouseover="showTip(event, 'fs70', 142)" class="i">id</span>))
        <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">select</span> (<span class="i">Quote</span><span class="o">.</span><span class="i">X</span>(<span class="k">fun</span> <span class="i">x</span> <span class="k">-&gt;</span> { <span class="i">x</span> <span class="k">with</span> <span class="i">Value</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs71', 143)" onmouseover="showTip(event, 'fs71', 143)" class="i">temp</span> }))
        <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">update</span> <span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">execute</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs69', 144)" onmouseover="showTip(event, 'fs69', 144)" class="i">persister</span><span class="o">.</span><span class="i">Interpret</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 145)" onmouseover="showTip(event, 'fs72', 145)" class="f">thresholdAnalyser</span> (<span onmouseout="hideTip(event, 'fs69', 146)" onmouseover="showTip(event, 'fs69', 146)" class="i">persister</span><span class="o">:</span><span class="i">Interpreter</span>) <span class="o">=</span> 
    <span class="c">// realistically we&#39;d use the ^ persister to read the threshold value from the database, but let&#39;s keep it simple</span>
    <span class="k">function</span> 
    | <span onmouseout="hideTip(event, 'fs65', 147)" onmouseover="showTip(event, 'fs65', 147)" class="p">Update</span>(<span onmouseout="hideTip(event, 'fs70', 148)" onmouseover="showTip(event, 'fs70', 148)" class="i">id</span>, <span onmouseout="hideTip(event, 'fs71', 149)" onmouseover="showTip(event, 'fs71', 149)" class="i">temp</span>) <span class="k">when</span> <span onmouseout="hideTip(event, 'fs71', 150)" onmouseover="showTip(event, 'fs71', 150)" class="i">temp</span> <span class="o">&gt;</span> <span class="n">100</span> <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs66', 151)" onmouseover="showTip(event, 'fs66', 151)" class="p">Alarm</span>(<span onmouseout="hideTip(event, 'fs70', 152)" onmouseover="showTip(event, 'fs70', 152)" class="i">id</span>,<span onmouseout="hideTip(event, 'fs71', 153)" onmouseover="showTip(event, 'fs71', 153)" class="i">temp</span>)]
    | _ <span class="k">-&gt;</span> []
    <span class="o">&gt;</span><span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs73', 154)" onmouseover="showTip(event, 'fs73', 154)" class="i">async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs74', 155)" onmouseover="showTip(event, 'fs74', 155)" class="f">Return</span>
</code></pre></td>
</tr>
</table>
<h3><a name="Topology" class="anchor" href="#Topology">Topology</a></h3>
<p>Finally, we put things together in a topology:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 156)" onmouseover="showTip(event, 'fs2', 156)" class="i">FsShelter</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs75', 157)" onmouseover="showTip(event, 'fs75', 157)" class="i">DSL</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 158)" onmouseover="showTip(event, 'fs2', 158)" class="i">FsShelter</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 159)" onmouseover="showTip(event, 'fs3', 159)" class="i">Extras</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 160)" onmouseover="showTip(event, 'fs76', 160)" class="i">sampleTopology</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 161)" onmouseover="showTip(event, 'fs77', 161)" class="f">topology</span> <span class="s">&quot;sample&quot;</span> {
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 162)" onmouseover="showTip(event, 'fs78', 162)" class="i">sensorEvents</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs79', 163)" onmouseover="showTip(event, 'fs79', 163)" class="f">createQueueSpout</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs80', 164)" onmouseover="showTip(event, 'fs80', 164)" class="i">m</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs53', 165)" onmouseover="showTip(event, 'fs53', 165)" class="t">SensorReading</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs65', 166)" onmouseover="showTip(event, 'fs65', 166)" class="p">Update</span> (<span onmouseout="hideTip(event, 'fs80', 167)" onmouseover="showTip(event, 'fs80', 167)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 168)" onmouseover="showTip(event, 'fs54', 168)" class="i">Id</span>, <span onmouseout="hideTip(event, 'fs80', 169)" onmouseover="showTip(event, 'fs80', 169)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 170)" onmouseover="showTip(event, 'fs56', 170)" class="i">Temp</span>))
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs81', 171)" onmouseover="showTip(event, 'fs81', 171)" class="f">runReliableSpout</span> (<span onmouseout="hideTip(event, 'fs17', 172)" onmouseover="showTip(event, 'fs17', 172)" class="f">withQueueConsumer</span> <span class="s">&quot;Topics.Sensor.Started&quot;</span> <span class="s">&quot;sensor_started&quot;</span>) <span onmouseout="hideTip(event, 'fs82', 173)" onmouseover="showTip(event, 'fs82', 173)" class="f">ackerOfConsumer</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs83', 174)" onmouseover="showTip(event, 'fs83', 174)" class="i">sensorWriter</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs84', 175)" onmouseover="showTip(event, 'fs84', 175)" class="f">createPersistBolt</span> <span onmouseout="hideTip(event, 'fs83', 176)" onmouseover="showTip(event, 'fs83', 176)" class="f">sensorWriter</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs85', 177)" onmouseover="showTip(event, 'fs85', 177)" class="f">runBolt</span> <span onmouseout="hideTip(event, 'fs45', 178)" onmouseover="showTip(event, 'fs45', 178)" class="f">withPersisterArgs</span> 

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs86', 179)" onmouseover="showTip(event, 'fs86', 179)" class="i">thresholdAnalyser</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs87', 180)" onmouseover="showTip(event, 'fs87', 180)" class="f">createTransformBolt</span> <span onmouseout="hideTip(event, 'fs86', 181)" onmouseover="showTip(event, 'fs86', 181)" class="f">thresholdAnalyser</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs85', 182)" onmouseover="showTip(event, 'fs85', 182)" class="f">runBolt</span> <span onmouseout="hideTip(event, 'fs51', 183)" onmouseover="showTip(event, 'fs51', 183)" class="f">withReaderArgs</span> 

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs88', 184)" onmouseover="showTip(event, 'fs88', 184)" class="i">alertNotifier</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs89', 185)" onmouseover="showTip(event, 'fs89', 185)" class="f">createNotifierBolt</span> (<span class="k">function</span> <span onmouseout="hideTip(event, 'fs66', 186)" onmouseover="showTip(event, 'fs66', 186)" class="p">Alarm</span> (<span onmouseout="hideTip(event, 'fs90', 187)" onmouseover="showTip(event, 'fs90', 187)" class="i">sensorId</span>,<span onmouseout="hideTip(event, 'fs71', 188)" onmouseover="showTip(event, 'fs71', 188)" class="i">temp</span>) <span class="k">-&gt;</span> <span class="s">&quot;Topics.Alarm&quot;</span>, 
                                                              { <span onmouseout="hideTip(event, 'fs58', 189)" onmouseover="showTip(event, 'fs58', 189)" class="t">SensorAlert</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 190)" onmouseover="showTip(event, 'fs59', 190)" class="i">Id</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs90', 191)" onmouseover="showTip(event, 'fs90', 191)" class="i">sensorId</span>
                                                                <span onmouseout="hideTip(event, 'fs91', 192)" onmouseover="showTip(event, 'fs91', 192)" class="i">Text</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs92', 193)" onmouseover="showTip(event, 'fs92', 193)" class="f">sprintf</span> <span class="s">&quot;At </span><span class="pf">%A</span><span class="s"> the reactor went critical&quot;</span> <span onmouseout="hideTip(event, 'fs93', 194)" onmouseover="showTip(event, 'fs93', 194)" class="t">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs94', 195)" onmouseover="showTip(event, 'fs94', 195)" class="i">Now</span>})
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs85', 196)" onmouseover="showTip(event, 'fs85', 196)" class="f">runBolt</span> (<span onmouseout="hideTip(event, 'fs27', 197)" onmouseover="showTip(event, 'fs27', 197)" class="f">withPublisher</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs95', 198)" onmouseover="showTip(event, 'fs95', 198)" class="f">publishJson</span> <span class="s">&quot;amq.topic&quot;</span>)

    <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs78', 199)" onmouseover="showTip(event, 'fs78', 199)" class="i">sensorEvents</span> <span class="o">==&gt;</span> <span onmouseout="hideTip(event, 'fs83', 200)" onmouseover="showTip(event, 'fs83', 200)" class="i">sensorWriter</span> <span class="o">|&gt;</span> <span class="i">shuffle</span><span class="o">.</span><span class="i">on</span> <span onmouseout="hideTip(event, 'fs65', 201)" onmouseover="showTip(event, 'fs65', 201)" class="i">Update</span>
    <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs78', 202)" onmouseover="showTip(event, 'fs78', 202)" class="i">sensorEvents</span> <span class="o">==&gt;</span> <span onmouseout="hideTip(event, 'fs86', 203)" onmouseover="showTip(event, 'fs86', 203)" class="i">thresholdAnalyser</span> <span class="o">|&gt;</span> <span class="i">shuffle</span><span class="o">.</span><span class="i">on</span> <span onmouseout="hideTip(event, 'fs65', 204)" onmouseover="showTip(event, 'fs65', 204)" class="i">Update</span>

    <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs86', 205)" onmouseover="showTip(event, 'fs86', 205)" class="i">thresholdAnalyser</span> <span class="o">--&gt;</span> <span onmouseout="hideTip(event, 'fs88', 206)" onmouseover="showTip(event, 'fs88', 206)" class="i">alertNotifier</span> <span class="o">|&gt;</span> <span class="i">shuffle</span><span class="o">.</span><span class="i">on</span> <span onmouseout="hideTip(event, 'fs66', 207)" onmouseover="showTip(event, 'fs66', 207)" class="i">Alarm</span>
}
</code></pre></td>
</tr>
</table>
<h3><a name="Summary" class="anchor" href="#Summary">Summary</a></h3>
<p>This example outlined wiring of the persistence and messaging dependencies into the core logic of the application using FsShelter.Extra's components.
The topology is available for inspection and instantiation w/o imposing the runtime requirements, such as configuration and connectivity.
At the same time, core logic is concise, focused on the problem and testable in isolation.</p>

<div class="tip" id="fs1">namespace FsBunny</div>
<div class="tip" id="fs2">namespace FsShelter</div>
<div class="tip" id="fs3">namespace FsShelter.Extras</div>
<div class="tip" id="fs4">namespace FsShelter.Extras.Assemblers</div>
<div class="tip" id="fs5">namespace System</div>
<div class="tip" id="fs6">namespace RabbitMQ</div>
<div class="tip" id="fs7">namespace RabbitMQ.Client</div>
<div class="tip" id="fs8">val mkEventStreams : connectionString:string -&gt; RabbitMqEventStreams<br /><br />Full name: Bootstrap.RabbitMq.mkEventStreams</div>
<div class="tip" id="fs9">val connectionString : string</div>
<div class="tip" id="fs10">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs11">val uri : Uri</div>
<div class="tip" id="fs12">Multiple items<br />type Uri =<br />&#160;&#160;new : uriString:string -&gt; Uri + 5 overloads<br />&#160;&#160;member AbsolutePath : string<br />&#160;&#160;member AbsoluteUri : string<br />&#160;&#160;member Authority : string<br />&#160;&#160;member DnsSafeHost : string<br />&#160;&#160;member Equals : comparand:obj -&gt; bool<br />&#160;&#160;member Fragment : string<br />&#160;&#160;member GetComponents : components:UriComponents * format:UriFormat -&gt; string<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member GetLeftPart : part:UriPartial -&gt; string<br />&#160;&#160;...<br /><br />Full name: System.Uri<br /><br />--------------------<br />Uri(uriString: string) : unit<br />Uri(uriString: string, uriKind: UriKind) : unit<br />Uri(baseUri: Uri, relativeUri: string) : unit<br />Uri(baseUri: Uri, relativeUri: Uri) : unit</div>
<div class="tip" id="fs13">val cf : ConnectionFactory</div>
<div class="tip" id="fs14">Multiple items<br />type ConnectionFactory =<br />&#160;&#160;new : unit -&gt; ConnectionFactory<br />&#160;&#160;val UserName : string<br />&#160;&#160;val Password : string<br />&#160;&#160;val VirtualHost : string<br />&#160;&#160;val RequestedChannelMax : uint16<br />&#160;&#160;val RequestedFrameMax : uint32<br />&#160;&#160;val RequestedHeartbeat : uint16<br />&#160;&#160;val ClientProperties : IDictionary<br />&#160;&#160;val Ssl : SslOption<br />&#160;&#160;val HostName : string<br />&#160;&#160;...<br /><br />Full name: RabbitMQ.Client.ConnectionFactory<br /><br />--------------------<br />ConnectionFactory() : unit</div>
<div class="tip" id="fs15">Multiple items<br />type RabbitMqEventStreams =<br />&#160;&#160;interface EventStreams<br />&#160;&#160;new : factory:ConnectionFactory * defaultExchange:string -&gt; RabbitMqEventStreams<br />&#160;&#160;new : factory:ConnectionFactory * defaultExchange:string * retries:uint16 * limit:uint16 -&gt; RabbitMqEventStreams<br /><br />Full name: FsBunny.RabbitMqEventStreams<br /><br />--------------------<br />new : factory:ConnectionFactory * defaultExchange:string -&gt; RabbitMqEventStreams<br />new : factory:ConnectionFactory * defaultExchange:string * retries:uint16 * limit:uint16 -&gt; RabbitMqEventStreams</div>
<div class="tip" id="fs16">val rabbit : string<br /><br />Full name: Bootstrap.rabbit</div>
<div class="tip" id="fs17">val withQueueConsumer : topic:string -&gt; queue:string -&gt; log:&#39;a -&gt; cfg:&#39;b -&gt; Consumer&lt;&#39;c&gt;<br /><br />Full name: Bootstrap.withQueueConsumer<br /><em><br /><br />&#160;Create a consumer based on the arguments.</em></div>
<div class="tip" id="fs18">val topic : string</div>
<div class="tip" id="fs19">val queue : string</div>
<div class="tip" id="fs20">val log : &#39;a</div>
<div class="tip" id="fs21">val cfg : &#39;b</div>
<div class="tip" id="fs22">val eventStreams : EventStreams</div>
<div class="tip" id="fs23">module RabbitMq<br /><br />from Bootstrap<br /><em><br /><br />&#160;DAL helpers</em></div>
<div class="tip" id="fs24">type EventStreams =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;abstract member Default : unit -&gt; Exchange<br />&#160;&#160;&#160;&#160;abstract member GetConsumer : Queue -&gt; Exchange -&gt; Assembler&lt;&#39;T&gt; -&gt; Consumer&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;abstract member GetPublisher : Disassembler&lt;&#39;T&gt; -&gt; Publisher&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;abstract member Routed : string -&gt; Exchange<br />&#160;&#160;&#160;&#160;abstract member UsingPublisher : Disassembler&lt;&#39;T&gt; -&gt; (Publisher&lt;&#39;T&gt; -&gt; unit) -&gt; unit<br />&#160;&#160;end<br /><br />Full name: FsBunny.EventStreams</div>
<div class="tip" id="fs25"></div>
<div class="tip" id="fs26">union case Queue.Persistent: string -&gt; Queue</div>
<div class="tip" id="fs27">val withPublisher : publish:(EventStreams -&gt; &#39;a) -&gt; log:&#39;b -&gt; cfg:&#39;c -&gt; (&#39;d -&gt; &#39;e -&gt; &#39;d * &#39;a)<br /><br />Full name: Bootstrap.withPublisher<br /><em><br /><br />&#160;Create a routed publisher based on the arguments.</em></div>
<div class="tip" id="fs28">val publish : (EventStreams -&gt; &#39;a)</div>
<div class="tip" id="fs29">val log : &#39;b</div>
<div class="tip" id="fs30">val cfg : &#39;c</div>
<div class="tip" id="fs31">val tuple : &#39;d</div>
<div class="tip" id="fs32">val emit : &#39;e</div>
<div class="tip" id="fs33">val publishJson : exchange:string -&gt; eventStreams:EventStreams -&gt; topic:string * msg:Messaging.SensorAlert -&gt; unit<br /><br />Full name: Bootstrap.publishJson<br /><em><br /><br />&#160;Publish Json</em></div>
<div class="tip" id="fs34">val exchange : string</div>
<div class="tip" id="fs35">val msg : Messaging.SensorAlert</div>
<div class="tip" id="fs36">union case Exchange.Routed: name: string * topic: string -&gt; Exchange</div>
<div class="tip" id="fs37">val mkInterpreter : mkSession:(string -&gt; &#39;a) -&gt; name:string -&gt; &#39;b<br /><br />Full name: Bootstrap.Cassandra.mkInterpreter</div>
<div class="tip" id="fs38">val mkSession : (string -&gt; &#39;a)</div>
<div class="tip" id="fs39">val name : string</div>
<div class="tip" id="fs40">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs41">val session : &#39;a</div>
<div class="tip" id="fs42">val mkSession : connectionString:string -&gt; &#39;a<br /><br />Full name: Bootstrap.Cassandra.mkSession</div>
<div class="tip" id="fs43">val id : x:&#39;T -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.id</div>
<div class="tip" id="fs44">val cassandra : string<br /><br />Full name: Bootstrap.cassandra</div>
<div class="tip" id="fs45">val withPersisterArgs : log:&#39;a -&gt; cfg:&#39;b -&gt; (&#39;c -&gt; &#39;d -&gt; ((&#39;e -&gt; &#39;f) -&gt; &#39;f) * &#39;c)<br /><br />Full name: Bootstrap.withPersisterArgs</div>
<div class="tip" id="fs46">val persister : &#39;e</div>
<div class="tip" id="fs47">module Cassandra<br /><br />from Bootstrap</div>
<div class="tip" id="fs48">val input : &#39;c</div>
<div class="tip" id="fs49">val emit : &#39;d</div>
<div class="tip" id="fs50">val f : (&#39;e -&gt; &#39;f)</div>
<div class="tip" id="fs51">val withReaderArgs : log:&#39;a -&gt; cfg:&#39;b -&gt; (&#39;c -&gt; &#39;d -&gt; ((&#39;e -&gt; &#39;f) -&gt; &#39;f) * &#39;c * &#39;d)<br /><br />Full name: Bootstrap.withReaderArgs</div>
<div class="tip" id="fs52">Multiple items<br />type AutoOpenAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; AutoOpenAttribute<br />&#160;&#160;new : path:string -&gt; AutoOpenAttribute<br />&#160;&#160;member Path : string<br /><br />Full name: Microsoft.FSharp.Core.AutoOpenAttribute<br /><br />--------------------<br />new : unit -&gt; AutoOpenAttribute<br />new : path:string -&gt; AutoOpenAttribute</div>
<div class="tip" id="fs53">type SensorReading =<br />&#160;&#160;{Id: Guid;<br />&#160;&#160;&#160;Temp: int;}<br /><br />Full name: Bootstrap.Messaging.SensorReading</div>
<div class="tip" id="fs54">SensorReading.Id: Guid</div>
<div class="tip" id="fs55">Multiple items<br />type Guid =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : b:byte[] -&gt; Guid + 4 overloads<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Equals : o:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member ToByteArray : unit -&gt; byte[]<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string + 2 overloads<br />&#160;&#160;&#160;&#160;static val Empty : Guid<br />&#160;&#160;&#160;&#160;static member NewGuid : unit -&gt; Guid<br />&#160;&#160;&#160;&#160;static member Parse : input:string -&gt; Guid<br />&#160;&#160;&#160;&#160;static member ParseExact : input:string * format:string -&gt; Guid<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.Guid<br /><br />--------------------<br />Guid()<br />Guid(b: byte []) : unit<br />Guid(g: string) : unit<br />Guid(a: int, b: int16, c: int16, d: byte []) : unit<br />Guid(a: uint32, b: uint16, c: uint16, d: byte, e: byte, f: byte, g: byte, h: byte, i: byte, j: byte, k: byte) : unit<br />Guid(a: int, b: int16, c: int16, d: byte, e: byte, f: byte, g: byte, h: byte, i: byte, j: byte, k: byte) : unit</div>
<div class="tip" id="fs56">SensorReading.Temp: int</div>
<div class="tip" id="fs57">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs58">type SensorAlert =<br />&#160;&#160;{Id: Guid;<br />&#160;&#160;&#160;Text: string;}<br /><br />Full name: Bootstrap.Messaging.SensorAlert</div>
<div class="tip" id="fs59">SensorAlert.Id: Guid</div>
<div class="tip" id="fs60">Multiple items<br />SensorAlert.Text: string<br /><br />--------------------<br />namespace System.Text</div>
<div class="tip" id="fs61">type Sensor =<br />&#160;&#160;{Id: Guid;<br />&#160;&#160;&#160;Value: int;}<br /><br />Full name: Bootstrap.Persistence.Sensor</div>
<div class="tip" id="fs62">Sensor.Id: Guid</div>
<div class="tip" id="fs63">Sensor.Value: int</div>
<div class="tip" id="fs64">type Stream =<br />&#160;&#160;| Update of sensorId: Guid * temp: int<br />&#160;&#160;| Alarm of sensorId: Guid * temp: int<br />&#160;&#160;| NotFound of sensorId: Guid<br /><br />Full name: Bootstrap.Stream<br /><em><br /><br />&#160;Topology streams</em></div>
<div class="tip" id="fs65">union case Stream.Update: sensorId: Guid * temp: int -&gt; Stream</div>
<div class="tip" id="fs66">union case Stream.Alarm: sensorId: Guid * temp: int -&gt; Stream</div>
<div class="tip" id="fs67">union case Stream.NotFound: sensorId: Guid -&gt; Stream</div>
<div class="tip" id="fs68">val sensorWriter : persister:&#39;a -&gt; _arg1:Stream -&gt; &#39;b<br /><br />Full name: Bootstrap.sensorWriter</div>
<div class="tip" id="fs69">val persister : &#39;a</div>
<div class="tip" id="fs70">val id : Guid</div>
<div class="tip" id="fs71">val temp : int</div>
<div class="tip" id="fs72">val thresholdAnalyser : persister:&#39;a -&gt; (Stream -&gt; Async&lt;Stream list&gt;)<br /><br />Full name: Bootstrap.thresholdAnalyser</div>
<div class="tip" id="fs73">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs74">member AsyncBuilder.Return : value:&#39;T -&gt; Async&lt;&#39;T&gt;</div>
<div class="tip" id="fs75">module DSL<br /><br />from FsShelter</div>
<div class="tip" id="fs76">val sampleTopology : FsShelter.Topology.Topology&lt;obj&gt;<br /><br />Full name: Bootstrap.sampleTopology</div>
<div class="tip" id="fs77">val topology : name:string -&gt; TopologyBuilder<br /><br />Full name: FsShelter.DSL.topology</div>
<div class="tip" id="fs78">val sensorEvents : FsShelter.Topology.Spout&lt;Stream&gt;</div>
<div class="tip" id="fs79">val createQueueSpout : toTuple:(&#39;a -&gt; &#39;b) -&gt; consumer:Consumer&lt;&#39;a&gt; -&gt; Async&lt;(string * &#39;b) option&gt;<br /><br />Full name: FsShelter.Extras.Components.createQueueSpout</div>
<div class="tip" id="fs80">val m : SensorReading</div>
<div class="tip" id="fs81">val runReliableSpout : mkArgs:((FsShelter.Multilang.LogLevel -&gt; string -&gt; unit) -&gt; FsShelter.Conf -&gt; &#39;a) -&gt; mkAcker:(&#39;a -&gt; Acker) -&gt; next:Next&lt;&#39;a,(string * &#39;t)&gt; -&gt; FsShelter.Topology.Spout&lt;&#39;t&gt;<br /><br />Full name: FsShelter.DSL.runReliableSpout</div>
<div class="tip" id="fs82">val ackerOfConsumer : consumer:Consumer&lt;&#39;a&gt; -&gt; Acker<br /><br />Full name: FsShelter.Extras.Components.ackerOfConsumer</div>
<div class="tip" id="fs83">val sensorWriter : FsShelter.Topology.Bolt&lt;Stream&gt;</div>
<div class="tip" id="fs84">val createPersistBolt : persist:(&#39;a -&gt; &#39;b -&gt; Async&lt;&#39;c&gt;) -&gt; using:((&#39;a -&gt; Async&lt;&#39;c&gt;) -&gt; &#39;d) * input:&#39;b -&gt; &#39;d<br /><br />Full name: FsShelter.Extras.Components.createPersistBolt</div>
<div class="tip" id="fs85">val runBolt : mkArgs:((FsShelter.Multilang.LogLevel -&gt; string -&gt; unit) -&gt; FsShelter.Conf -&gt; &#39;t -&gt; (&#39;t -&gt; unit) -&gt; &#39;a) -&gt; consume:Consume&lt;&#39;a&gt; -&gt; FsShelter.Topology.Bolt&lt;&#39;t&gt;<br /><br />Full name: FsShelter.DSL.runBolt</div>
<div class="tip" id="fs86">val thresholdAnalyser : FsShelter.Topology.Bolt&lt;Stream&gt;</div>
<div class="tip" id="fs87">val createTransformBolt : transform:(&#39;a -&gt; &#39;b -&gt; Async&lt;#seq&lt;&#39;d&gt;&gt;) -&gt; using:((&#39;a -&gt; Async&lt;unit&gt;) -&gt; &#39;e) * input:&#39;b * out:(&#39;d -&gt; unit) -&gt; &#39;e<br /><br />Full name: FsShelter.Extras.Components.createTransformBolt</div>
<div class="tip" id="fs88">val alertNotifier : FsShelter.Topology.Bolt&lt;Stream&gt;</div>
<div class="tip" id="fs89">val createNotifierBolt : ofTuple:(&#39;a -&gt; &#39;b) -&gt; input:&#39;a * publish:Publisher&lt;&#39;b&gt; -&gt; Async&lt;unit&gt;<br /><br />Full name: FsShelter.Extras.Components.createNotifierBolt</div>
<div class="tip" id="fs90">val sensorId : Guid</div>
<div class="tip" id="fs91">namespace System.Text</div>
<div class="tip" id="fs92">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs93">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs94">property DateTime.Now: DateTime</div>
<div class="tip" id="fs95">val publishJson : exchange:string -&gt; eventStreams:EventStreams -&gt; topic:string * msg:SensorAlert -&gt; unit<br /><br />Full name: Bootstrap.publishJson<br /><em><br /><br />&#160;Publish Json</em></div>

        </div>
        <div class="span3">
          <img src="https://prolucid.github.io/FsShelter.Extras/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">FsShelter.Extras</li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/FsShelter.Extras">Get Library via NuGet</a></li>
            <li><a href="https://github.com/Prolucid/FsShelter.Extras">Source Code on GitHub</a></li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/license.html">License</a></li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/overview.html">Overview</a></li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/bootstrap.html">Bootstrapping the dependencies</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="https://prolucid.github.io/FsShelter.Extras/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
  </html>
